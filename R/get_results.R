#' @title Get the Premier League results for the desired seasons
#'
#' @description This function takes the latest data on this Premier League season and combines it with corresponding results from previous seasons, if desired.
#' @param results_thisSeason These are the results generated by running `get_openData` on the current season, such as at 'https://raw.githubusercontent.com/openfootball/football.json/refs/heads/master/2024-25/en.1.json'.
#' @param seasons This is the integer required for the number of previous seasons to include. It defaults to zero.
#' @keywords Sport
#' @export
#' @examples
#' \dontrun{
#' get_results(
#'   results_thisSeason = data_thisSeason,
#'   seasons = 1L
#'   )
#' }
#'
#' @importFrom rlang .data

get_results <- function(results_thisSeason, seasons = 0L){

  previous_seasons <- PremPredict::previous_seasons

  temp <- results_thisSeason |>
    dplyr::mutate(
      FTHG = as.numeric(.data$FTHG),
      FTAG = as.numeric(.data$FTAG),
      FTR = as.character(.data$FTR)
    ) |>
    dplyr::bind_rows(previous_seasons) |>
    dplyr::mutate(id_match = (.data$year_end * 1000) + .data$number_match_integer) |>
    dplyr::arrange(.data$id_match) |>
    dplyr::mutate(
      match = sprintf("%03d", dplyr::row_number()),
      row_order = as.integer(.data$match)
    ) |>
    dplyr::select(-"id_match", -"number_match", -"number_match_integer")

  year_latest <- temp |>
    dplyr::distinct(.data$year_end) |>
    dplyr::filter(.data$year_end == max(.data$year_end)) |>
    dplyr::pull(.data$year_end)

  temp |>
    dplyr::filter(
      .data$year_end <= year_latest,
      .data$year_end >= year_latest - seasons
      ) |>
    dplyr::select(-"year_end")

  }
